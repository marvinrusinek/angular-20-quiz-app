@let opts = optionBindings || [];

@if (canShowOptions()) {
  <!-- OPTIONS ARE READY -->
  <form
    [formGroup]="form"
    class="options-form"
  >
    @switch (type) {
      <!-- SINGLE-ANSWER (RADIO) -->
      @case ('single') {
        <mat-radio-group
          class="options-group options"
          formControlName="selectedOptionId"
        >
          @for (b of opts; let i = $index; track trackByOptionId(b, i)) {
            <app-option-item
              [b]="b"
              [i]="i"
              [type]="'single'"
              [form]="form"
              [shouldResetBackground]="shouldResetBackground"
              [feedbackConfig]="feedbackConfigs[keyOf(b.option, i)]"
              [sharedOptionConfig]="getSharedOptionConfig(b, i)"
              [highlightedOptionIds]="highlightedOptionIds"
              [flashDisabledSet]="flashDisabledSet"
              [forceDisableAll]="forceDisableAll"
              [timerExpiredForQuestion]="timerExpiredForQuestion"
              [isLocked]="isLocked(b, i)"
              [currentQuestionIndex]="currentQuestionIndex"
              [disabledOptionsPerQuestion]="disabledOptionsPerQuestion"
              (optionChanged)="onOptionChanged($event.b, $event.i, $event.event)"
              (optionInteraction)="onOptionInteraction($event.b, $event.i, $event.event)"
              (contentClick)="onOptionContentClick($event.b, $event.i, $event.event)"
            />
          }
        </mat-radio-group>
      }

      <!-- MULTIPLE-ANSWER (CHECKBOX) -->
      @case ('multiple') {
        <div
          class="options-group options"
          role="group"
          aria-label="Select one or more options"
        >
          @for (b of opts; let i = $index; track trackByOptionId(b, i)) {
            <app-option-item
              [b]="b"
              [i]="i"
              [type]="'multiple'"
              [form]="form"
              [shouldResetBackground]="shouldResetBackground"
              [feedbackConfig]="feedbackConfigs[keyOf(b.option, i)]"
              [sharedOptionConfig]="getSharedOptionConfig(b, i)"
              [highlightedOptionIds]="highlightedOptionIds"
              [flashDisabledSet]="flashDisabledSet"
              [forceDisableAll]="forceDisableAll"
              [timerExpiredForQuestion]="timerExpiredForQuestion"
              [isLocked]="isLocked(b, i)"
              [currentQuestionIndex]="currentQuestionIndex"
              [disabledOptionsPerQuestion]="disabledOptionsPerQuestion"
              (optionChanged)="onOptionChanged($event.b, $event.i, $event.event)"
              (optionInteraction)="onOptionInteraction($event.b, $event.i, $event.event)"
              (contentClick)="onOptionContentClick($event.b, $event.i, $event.event)"
            />
          }
        </div>
      }
    }
  </form>
} @else if (opts.length === 0) {
  <span>Options not ready&hellip;</span>
}
